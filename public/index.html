<html>
  <head>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="data.js"></script>
    <script>
      suggestions = [];

      function find(q) {
        if (q == null || jQuery.trim(q).length == 0) {
          return [];
        }

        var sugs = [];
        jQuery.each(gems, function(i, gem) {
          var gemResult = null
          if (gem.name.toLowerCase().indexOf(q) >= 0) {
            var gemResult = [gem, []]
            sugs.push(gemResult);
          }
          jQuery.each(gem.classes, function(o, klass) {
            if (klass.name.toLowerCase().indexOf(q) >= 0) {
              if (!gemResult) {
                gemResult = [gem, []]
                sugs.push(gemResult);
              }
              gemResult[1].push(klass);
            }
            jQuery.each(klass.methods, function(j, method) {
              if (method.name.toLowerCase().indexOf(q) >= 0) {
                if (!gemResult) {
                  gemResult = [gem, []]
                  sugs.push(gemResult);
                }
                method.parentClass = klass;
                gemResult[1].push(method);
              }
            })
          })
        });
        return sugs;
      }

      $(document).ready(function(){
        $('input').keyup(function(e) {
          matches = find(e.target.value.toLowerCase());

          html = '';
          jQuery.each(matches, function(i, gemResult) {
            html += '<div class="gem"><a target="iframe" href="file://' + gemResult[0].dir + '/index.html">' + gemResult[0].name + '</a></div>'
            jQuery.each(gemResult[1], function(j, classOrMethodResult) {
              classHtml = '';
              if (classOrMethodResult.parentClass) {
                classHtml = '&nbsp;(' + classOrMethodResult.parentClass.name + ')';
              }
              html += '<div class="class-or-method"><a target="iframe" href="file://' + gemResult[0].dir + '/' + classOrMethodResult.url + '">' + classOrMethodResult.name + '</a> ' + classHtml + '</div>'
            });
          });

          $('#suggestions').html(html);
        });

        $('#suggestions').click(function(e) {
          if (e.target.nodeName == "A") {
            $('#suggestions').hide();
          }
        });

        $('input').focus(function() {
          $('#suggestions').show();
        });
      });
    </script>

    <style>
      #suggestions {
        border: 1px solid #bbb;
        position: absolute;
        top: 35px;
        left: 14px;
        background-color: #fff;
        color: #aaa;
      }

      #suggestions div.gem {
        font-weight: bold;
      }

      #suggestions div.class-or-method {
        padding-left: 1em;
      }

      #iframe {
        width: 100%;
        height: 600px;
      }
    </style>
  </head>
  <body>
    <form>
      <input>
    </form>
    <div id="suggestions">
    </div>
    <iframe id="iframe" name="iframe">
    </iframe>
  </body>
</html>
